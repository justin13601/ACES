predicates:
  spo2:
    code: lab_name//SpO2
  normal_spo2:
    code: lab_name//SpO2
    values_column: lab_value
    value_min: 90
    value_max: 120
    value_min_inclusive: True
    value_max_inclusive: True
  abnormal_spo2:
    code: lab_name//SpO2
    values_column: lab_value
    value_min: 120
    value_max: 90
    value_min_inclusive: False
    value_max_inclusive: False

trigger_event: normal_spo2

windows:
  input:
    start: NULL
    end: trigger
    start_inclusive: True
    end_inclusive: True
  gap:
    start: trigger
    end: start + 24h
    start_inclusive: False
    end_inclusive: True
  target:
    start: gap.end
    end: start + 7 days
    start_inclusive: False
    end_inclusive: True
    has:
      spo2: (1, None)
    label: abnormal_spo2
